window.theme.selectors.careers = {
  careersTitle: '.careers__title',
  careersSummary: '.careers__summary',
  careersRow: '.careers__accordion-row',
  careersFormTrigger: '.form-trigger'
};
document.querySelectorAll(window.theme.selectors.careers.careersTitle).forEach(title => {
  title.addEventListener('click', () => {
    document.querySelectorAll(window.theme.selectors.careers.careersRow).forEach(row => {
      if (row !== title.parentNode) {
        row.classList.remove('show');
      }
    });
    title.parentNode.classList.toggle('show');
  });
});

const openCareersForm = () => {
  var modal = document.querySelector('#careersForm');
  window.theme.modalOpen(modal);
};

const setRole = role => {
  function checkInputLoaded() {
    var inputRole = document.querySelector('input[name="applying-for"]');

    if (inputRole !== null) {
      inputRole.value = role;
      inputRole.readOnly = true;
    } else {
      setTimeout(checkInputLoaded, 500);
    }
  }

  checkInputLoaded();
};

const loadDynamicScript = role => {
  return new Promise(function (resolve, reject) {
    var s;
    s = document.createElement('script');
    s.id = 'elfScript';
    s.src = 'https://apps.elfsight.com/p/platform.js';
    s.onload = resolve;
    s.onerror = reject;
    document.head.appendChild(s);
  });
}; // Modal Triggers


document.querySelectorAll(window.theme.selectors.careers.careersFormTrigger).forEach(el => {
  el.addEventListener('click', function (e) {
    e.preventDefault();
    openCareersForm();
    loadDynamicScript().then(setRole(e.target.dataset.role));
  });
});